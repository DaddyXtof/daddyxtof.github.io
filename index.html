<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-03-02 Mon 10:13 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Christophe Dehon's Repository</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Christophe Dehon" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<style>*{font-family: Arial, Helvetica, sans-serif}</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Christophe Dehon's Repository</h1>
<div id="outline-container-org13c79b2" class="outline-2">
<h2 id="org13c79b2">Challenge #1 - Tool to create 3 tier environment.</h2>
<div class="outline-text-2" id="text-org13c79b2">
<p>
<i>A 3 tier environment is a common setup. Use a tool of your choosing/familiarity create these resources. Please remember we will not be judged on the outcome but more focusing on the approach, style and reproducibility.</i>
</p>

<p>
The three tier environment on <b>AWS</b> could be composed of:
</p>
<ul class="org-ul">
<li><b>Network Load Balancer</b> for access/resilience</li>
<li><b>EC2</b> for business logic (+presentation)</li>
<li><b>S3</b> for data repository</li>
</ul>
<p>
We would expect this environment to be setup across one region, one network and 2 availability zones.
In order to automate the generation of this environment we could use <b>Terraform</b>.
This would allow us to repeat this process faster and with confidence.
The .tf files would need to take care of:
</p>
<ul class="org-ul">
<li>setting up <b>EC2</b> (+apache) in the region</li>
<li>setting up a <b>VPC</b> with a private and a public subnet.</li>
<li>ensuring the storage/S3 environment is in the private subnet</li>
<li>ensuring the front-end is open to incoming public sessions (public subnet)</li>
<li>setting up <b>security groups</b></li>
<li>setting up <b>ELB</b></li>
<li>setting up <b>S3</b></li>
</ul>
<p>
(the order of the above needs to be validated).
</p>

<p>
The .tf files would also refer to keys/certificates required to connect to the AWS environment.
I do not have hands-on/immediate experience of crafting terraform files so cannot provide them but with more time this should not be difficult to do.
</p>
</div>
</div>
<div id="outline-container-org4cebae9" class="outline-2">
<h2 id="org4cebae9">Challenge #2 - Code to query meta data from an AWS instance and provide results in JSON format.</h2>
<div class="outline-text-2" id="text-org4cebae9">
<p>
<i>Summary</i>
</p>

<p>
<i>We need to write code that will query the meta data of an instance within aws and provide a json formatted output. The choice of language and implementation is up to you.</i>
</p>

<p>
<i>Bonus Points</i>
<i>The code allows for a particular data key to be retrieved individually</i>
</p>

<p>
A curl or a wget command can retrieve metadata from most vendor instances. One would need to ssh to the instance and issue a curl request there.
From the vendors documentation it appears that the response are not always in json so this needs to be validated (see code).
Therefore we could have the following python script.
The script saves the metadata in a metadata.txt and takes an argument for look up.
Code available here: <a href="https://github.com/DaddyXtof/metadata">https://github.com/DaddyXtof/metadata</a>
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #ffad29; font-weight: bold;">import</span> json
<span style="color: #ffad29; font-weight: bold;">import</span> requests
<span style="color: #ffad29; font-weight: bold;">import</span> sys

<span style="color: #dbdb95;">startingURL</span> = <span style="color: #e67128;">"http://169.254.169.254/latest/"</span>
<span style="color: #dbdb95;">dic</span> = {<span style="color: #e67128;">'latest'</span>: {}}


<span style="color: #ffad29; font-weight: bold;">def</span> <span style="color: #00ede1; font-weight: bold;">parseURL</span>(url, dic):
    <span style="color: #dbdb95;">resp</span> = requests.get(url)
    <span style="color: #ffad29; font-weight: bold;">if</span> resp.status_code == 404:
        <span style="color: #ffad29; font-weight: bold;">return</span>
    <span style="color: #ffad29; font-weight: bold;">for</span> r <span style="color: #ffad29; font-weight: bold;">in</span> resp.text.split(<span style="color: #e67128;">'\n'</span>):
        <span style="color: #ffad29; font-weight: bold;">if</span> <span style="color: #ffad29; font-weight: bold;">not</span> r:
            <span style="color: #ffad29; font-weight: bold;">continue</span>
        <span style="color: #ffad29; font-weight: bold;">if</span> r == <span style="color: #e67128;">"dynamic"</span> <span style="color: #ffad29; font-weight: bold;">or</span> r == <span style="color: #e67128;">"meta-data"</span> <span style="color: #ffad29; font-weight: bold;">or</span> r == <span style="color: #e67128;">"user-data"</span>:
            <span style="color: #dbdb95;">r</span> += <span style="color: #e67128;">'/'</span>
        <span style="color: #ffad29; font-weight: bold;">if</span> r[-1] != <span style="color: #e67128;">'/'</span>:
            <span style="color: #dbdb95;">dic</span>[r] = {}
            <span style="color: #dbdb95;">dic</span>[r] = getData(url + r)
            <span style="color: #ffad29; font-weight: bold;">if</span> <span style="color: #23d7d7;">len</span>(sys.argv) &gt; 1 <span style="color: #ffad29; font-weight: bold;">and</span> sys.argv[1] == r:
                <span style="color: #ffad29; font-weight: bold;">print</span>(sys.argv[1] + <span style="color: #e67128;">": "</span>)
                <span style="color: #ffad29; font-weight: bold;">print</span>(dic[r])
        <span style="color: #ffad29; font-weight: bold;">else</span>:
            <span style="color: #dbdb95;">newURL</span> = url + r
            <span style="color: #dbdb95;">newIndex</span> = r[0:<span style="color: #23d7d7;">len</span>(r) - 1]
            <span style="color: #dbdb95;">dic</span>[newIndex] = {}
            parseURL(newURL, dic[newIndex])
    <span style="color: #ffad29; font-weight: bold;">return</span> dic


<span style="color: #ffad29; font-weight: bold;">def</span> <span style="color: #00ede1; font-weight: bold;">getData</span>(url):
    <span style="color: #dbdb95;">a</span> = requests.get(url)
    <span style="color: #ffad29; font-weight: bold;">try</span>:
        <span style="color: #dbdb95;">val</span> = json.loads(a.text)
    <span style="color: #ffad29; font-weight: bold;">except</span> <span style="color: #34cae2;">ValueError</span>:
        <span style="color: #dbdb95;">val</span> = a.text
    <span style="color: #ffad29; font-weight: bold;">return</span> val


<span style="color: #ffad29; font-weight: bold;">if</span> <span style="color: #23d7d7;">__name__</span> == <span style="color: #e67128;">'__main__'</span>:
    <span style="color: #ffad29; font-weight: bold;">if</span> <span style="color: #23d7d7;">len</span>(sys.argv) &gt; 1:
        <span style="color: #ffad29; font-weight: bold;">print</span>(<span style="color: #e67128;">"Searching for... "</span> + sys.argv[1] + <span style="color: #e67128;">'\n'</span>)
    <span style="color: #ffad29; font-weight: bold;">with</span> <span style="color: #23d7d7;">open</span>(<span style="color: #e67128;">"metadata.txt"</span>, <span style="color: #e67128;">"w"</span>) <span style="color: #ffad29; font-weight: bold;">as</span> mFile:
        json.dump(parseURL(startingURL, dic), mFile, indent=4)
        <span style="color: #ffad29; font-weight: bold;">print</span>(<span style="color: #e67128;">'Latest metadata saved to metadata.txt'</span> + <span style="color: #e67128;">'\n'</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org9b80927" class="outline-2">
<h2 id="org9b80927">Challenge #3 - Function to get a key value back from nested objects.</h2>
<div class="outline-text-2" id="text-org9b80927">
<p>
<i>We have a nested object, we would like a function that you pass in the object and a key and get back the value. How this is implemented is up to you.</i>
</p>

<p>
<i>Example Inputs</i>
</p>

<p>
<i>object = {“a”:{“b”:{“c”:”d”}}}</i>
</p>

<p>
<i>key = a/b/c=</i>
</p>

<p>
<i>object = {“x”:{“y”:{“z”:”a”}}}</i>
</p>

<p>
<i>key = x/y/z=</i>
</p>

<p>
<i>value = a</i>
</p>

<p>
The code above (metadata) shows the recursive function required to navigate the branches (URL) of the metadata structure.
Using this example one could consider using the corresponding dictionary created as the nested object to lookup against.
Therefore a function to find the corresponding key in this object based on a key (a/b/c) is simply a reverse of that parseURL function - i.e. parse the key provided by the user and navigate the dictionary accordingly.
</p>
</div>
</div>
</div>
</body>
</html>
